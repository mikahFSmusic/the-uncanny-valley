{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/mfs/Desktop/web_apps/the-uncanny-valley/front/src/components/ImageMesh.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useFrame } from 'react-three-fiber';\nimport Box from './Box';\n\nconst norm = (val, minVal, maxVal, newMin, newMax) => {\n  return newMin + (val - minVal) * (newMax - newMin) / (maxVal - minVal);\n};\n\nexport const ImageMesh = props => {\n  _s();\n\n  const mesh = useRef();\n  const [boxes, addBox] = useState([]);\n  useEffect(() => {\n    if (props.imageData) {\n      const imgWidth = props.imageData.width;\n      const imgHeight = props.imageData.height;\n      const imgAspectRatio = imgWidth / imgHeight;\n      const scrWidth = window.innerWidth;\n      const scrHeight = window.innerHeight;\n      const scrAspectRatio = scrWidth / scrHeight;\n      const widthMod = 3 * imgAspectRatio / scrAspectRatio;\n      const xPadding = (2 - widthMod) / 2;\n      const xInc = widthMod / imgWidth;\n      const yInc = 2 / imgHeight;\n      const xStart = -1.0 + xPadding;\n      const yStart = 1.0;\n      let col = 0;\n      let row = 0;\n\n      for (let i = 0; i < props.imageData.data.length; i += 4) {\n        // create a point object with color data[i + 0], data[i + 1], data[i + 2], data[i + 3]\n        // and location\n        let x = xStart + col * xInc;\n        let y = yStart - row * yInc;\n        let z = norm(props.imageData.data[i + 3], 0, 255, -1, 1);\n\n        let thisBox = /*#__PURE__*/_jsxDEV(Box, {\n          position: [x, y, z]\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 23\n        }, this);\n\n        addBox([...boxes, thisBox]);\n      }\n    }\n  }, [props.imageData, boxes]);\n  console.log(boxes); // animation stage\n\n  useFrame(() => {\n    if (mesh.current) {}\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: boxes\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ImageMesh, \"6G2N789I5ta0DaPFb/36/bN6t3w=\", false, function () {\n  return [useFrame];\n});\n\n_c = ImageMesh;\n\nvar _c;\n\n$RefreshReg$(_c, \"ImageMesh\");","map":{"version":3,"sources":["/Users/mfs/Desktop/web_apps/the-uncanny-valley/front/src/components/ImageMesh.tsx"],"names":["React","useEffect","useRef","useState","useFrame","Box","norm","val","minVal","maxVal","newMin","newMax","ImageMesh","props","mesh","boxes","addBox","imageData","imgWidth","width","imgHeight","height","imgAspectRatio","scrWidth","window","innerWidth","scrHeight","innerHeight","scrAspectRatio","widthMod","xPadding","xInc","yInc","xStart","yStart","col","row","i","data","length","x","y","z","thisBox","console","log","current"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,EAAmCC,QAAnC,QAAmD,OAAnD;AACA,SAAoBC,QAApB,QAAoC,mBAApC;AAEA,OAAOC,GAAP,MAAgB,OAAhB;;AAEA,MAAMC,IAAI,GAAG,CAACC,GAAD,EAAcC,MAAd,EAA8BC,MAA9B,EAA8CC,MAA9C,EAA8DC,MAA9D,KAAiF;AAC5F,SAAOD,MAAM,GAAG,CAACH,GAAG,GAAGC,MAAP,KAAkBG,MAAM,GAAGD,MAA3B,KAAsCD,MAAM,GAAGD,MAA/C,CAAhB;AACD,CAFD;;AASA,OAAO,MAAMI,SAAS,GAAIC,KAAD,IAA2B;AAAA;;AAClD,QAAMC,IAAI,GAAGZ,MAAM,EAAnB;AACA,QAAM,CAACa,KAAD,EAAQC,MAAR,IAAkBb,QAAQ,CAAqB,EAArB,CAAhC;AACAF,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIY,KAAK,CAACI,SAAV,EAAqB;AACnB,YAAMC,QAAQ,GAAGL,KAAK,CAACI,SAAN,CAAgBE,KAAjC;AACA,YAAMC,SAAS,GAAGP,KAAK,CAACI,SAAN,CAAgBI,MAAlC;AACA,YAAMC,cAAc,GAAGJ,QAAQ,GAAGE,SAAlC;AAEA,YAAMG,QAAQ,GAAGC,MAAM,CAACC,UAAxB;AACA,YAAMC,SAAS,GAAGF,MAAM,CAACG,WAAzB;AACA,YAAMC,cAAc,GAAGL,QAAQ,GAAGG,SAAlC;AAEA,YAAMG,QAAQ,GAAI,IAAIP,cAAL,GAAuBM,cAAxC;AACA,YAAME,QAAQ,GAAG,CAAC,IAAID,QAAL,IAAiB,CAAlC;AACA,YAAME,IAAI,GAAGF,QAAQ,GAAGX,QAAxB;AACA,YAAMc,IAAI,GAAG,IAAIZ,SAAjB;AACA,YAAMa,MAAM,GAAG,CAAC,GAAD,GAAOH,QAAtB;AACA,YAAMI,MAAM,GAAG,GAAf;AACA,UAAIC,GAAG,GAAG,CAAV;AACA,UAAIC,GAAG,GAAG,CAAV;;AACA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,KAAK,CAACI,SAAN,CAAgBqB,IAAhB,CAAqBC,MAAzC,EAAiDF,CAAC,IAAE,CAApD,EAAuD;AACrD;AACA;AAEA,YAAIG,CAAC,GAAGP,MAAM,GAAIE,GAAG,GAAGJ,IAAxB;AACA,YAAIU,CAAC,GAAGP,MAAM,GAAKE,GAAG,GAAGJ,IAAzB;AACA,YAAIU,CAAC,GAAGpC,IAAI,CAACO,KAAK,CAACI,SAAN,CAAgBqB,IAAhB,CAAqBD,CAAC,GAAG,CAAzB,CAAD,EAA8B,CAA9B,EAAiC,GAAjC,EAAsC,CAAC,CAAvC,EAA0C,CAA1C,CAAZ;;AACA,YAAIM,OAAO,gBAAG,QAAC,GAAD;AAAa,UAAA,QAAQ,EAAE,CAACH,CAAD,EAAIC,CAAJ,EAAOC,CAAP;AAAvB,WAAUL,CAAV;AAAA;AAAA;AAAA;AAAA,gBAAd;;AACArB,QAAAA,MAAM,CAAC,CAAC,GAAGD,KAAJ,EAAW4B,OAAX,CAAD,CAAN;AACD;AACF;AAEF,GA9BQ,EA8BN,CAAC9B,KAAK,CAACI,SAAP,EAAkBF,KAAlB,CA9BM,CAAT;AAgCA6B,EAAAA,OAAO,CAACC,GAAR,CAAY9B,KAAZ,EAnCkD,CAoClD;;AACAX,EAAAA,QAAQ,CAAC,MAAM;AACb,QAAIU,IAAI,CAACgC,OAAT,EAAkB,CAEjB;AACF,GAJO,CAAR;AAMA,sBACE;AAAA,cACG/B;AADH;AAAA;AAAA;AAAA;AAAA,UADF;AAKD,CAhDM;;GAAMH,S;UAqCXR,Q;;;KArCWQ,S","sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\nimport { MeshProps, useFrame } from 'react-three-fiber'\nimport { Mesh } from 'three'\nimport Box from './Box'\n\nconst norm = (val: number, minVal: number, maxVal: number, newMin: number, newMax: number) => {\n  return newMin + (val - minVal) * (newMax - newMin) / (maxVal - minVal);\n}\n\ntype ImageMeshProps = {\n  meshProps?: MeshProps,\n  imageData?: ImageData\n}\n\nexport const ImageMesh = (props: ImageMeshProps) => {\n  const mesh = useRef<Mesh>();\n  const [boxes, addBox] = useState<Array<JSX.Element>>([]);\n  useEffect(() => {\n    if (props.imageData) {\n      const imgWidth = props.imageData.width;\n      const imgHeight = props.imageData.height;\n      const imgAspectRatio = imgWidth / imgHeight;\n\n      const scrWidth = window.innerWidth;\n      const scrHeight = window.innerHeight;\n      const scrAspectRatio = scrWidth / scrHeight;\n\n      const widthMod = (3 * imgAspectRatio) / scrAspectRatio;\n      const xPadding = (2 - widthMod) / 2;\n      const xInc = widthMod / imgWidth;\n      const yInc = 2 / imgHeight;\n      const xStart = -1.0 + xPadding;\n      const yStart = 1.0;\n      let col = 0;\n      let row = 0;\n      for (let i = 0; i < props.imageData.data.length; i+=4) {\n        // create a point object with color data[i + 0], data[i + 1], data[i + 2], data[i + 3]\n        // and location\n\n        let x = xStart + (col * xInc);\n        let y = yStart -  (row * yInc);\n        let z = norm(props.imageData.data[i + 3], 0, 255, -1, 1)\n        let thisBox = <Box key={i} position={[x, y, z]}></Box>\n        addBox([...boxes, thisBox])\n      }\n    }\n\n  }, [props.imageData, boxes])\n\n  console.log(boxes)\n  // animation stage\n  useFrame(() => {\n    if (mesh.current) {\n\n    }\n  })\n\n  return (\n    <div>\n      {boxes}\n    </div>\n  )\n}"]},"metadata":{},"sourceType":"module"}